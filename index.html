<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sistem Aset ICT - Nurul Syuhaida</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3b82f6; /* Biru Moden */
            --primary-dark: #2563eb;
            --sidebar-bg: #1e293b; /* Dark Blue untuk Sidebar (Nampak Pro) */
            --sidebar-text: #e2e8f0;
            --bg-body: #f3f4f6;
            --sidebar-width: 260px;
        }

        body { font-family: 'Inter', sans-serif; margin: 0; background: var(--bg-body); height: 100vh; overflow: hidden; }
        * { box-sizing: border-box; }

        /* ===========================
           1. LANDING PAGE (MUKA DEPAN)
           =========================== */
        #landing-page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; z-index: 2000; transition: transform 0.5s ease-in-out;
            padding: 20px;
        }
        .landing-box { text-align: center; max-width: 600px; width: 100%; animation: floatUp 0.8s ease-out; }
        @keyframes floatUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

        .menu-grid { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 40px; }
        
        /* Menu Card Design */
        .menu-card {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            padding: 20px; border-radius: 15px; cursor: pointer; display: flex; align-items: center; gap: 15px;
            transition: 0.3s;
        }
        .menu-card:hover { background: rgba(255,255,255,0.15); transform: translateY(-5px); border-color: var(--primary); }
        
        .footer-credit { margin-top: 60px; color: #64748b; font-size: 0.85rem; letter-spacing: 0.5px; }

        /* ===========================
           2. APP LAYOUT (DASHBOARD)
           =========================== */
        #app-container {
            display: none; height: 100vh; width: 100%; position: absolute; top: 0; left: 0;
            background: var(--bg-body);
        }
        #app-container.active { display: block; }

        /* --- MOBILE HEADER --- */
        .mobile-header {
            background: white; padding: 0 20px; display: flex; align-items: center; justify-content: space-between;
            height: 60px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: relative; z-index: 50;
        }
        .hamburger { font-size: 1.5rem; background: none; border: none; cursor: pointer; color: #334155; }
        
        /* --- SIDEBAR (DESIGN PRO) --- */
        .sidebar { 
            position: fixed; top: 0; left: 0; height: 100%; width: var(--sidebar-width);
            background: var(--sidebar-bg); color: var(--sidebar-text);
            z-index: 1000; transition: transform 0.3s ease;
            display: flex; flex-direction: column; padding: 25px;
            /* Mobile Default: Hidden */
            transform: translateX(-100%);
        }
        .sidebar.open { transform: translateX(0); } /* Class untuk Mobile Open */
        .overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:900; display:none; }
        .overlay.show { display:block; }

        .brand-logo { font-size: 1.3rem; font-weight: 700; color: white; margin-bottom: 40px; display: flex; align-items: center; gap: 10px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        
        .nav-link { 
            padding: 14px; margin-bottom: 8px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 12px; 
            color: #94a3b8; transition: 0.2s; font-weight: 500;
        }
        .nav-link:hover { background: rgba(255,255,255,0.05); color: white; }
        .nav-link.active { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
        
        .creator-badge { margin-top: auto; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
        .creator-badge small { color: #64748b; font-size: 0.7rem; display: block; margin-bottom: 3px; }
        .creator-badge b { color: white; font-size: 0.9rem; }

        /* --- MAIN CONTENT --- */
        .main-content {
            padding: 20px; height: calc(100vh - 60px); overflow-y: auto; -webkit-overflow-scrolling: touch;
            transition: margin 0.3s;
        }

        /* --- CARDS & FORMS --- */
        .page-section { display: none; animation: fadeIn 0.3s ease; max-width: 1000px; margin: 0 auto; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

        .card { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); margin-bottom: 20px; border: 1px solid #e5e7eb; }
        h2 { margin-top: 0; color: #1e293b; font-size: 1.4rem; margin-bottom: 25px; border-bottom: 2px solid #f3f4f6; padding-bottom: 15px; }

        .input-group { margin-bottom: 15px; }
        label { font-weight: 600; font-size: 0.85rem; color: #475569; margin-bottom: 6px; display: block; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-family: inherit; font-size: 0.95rem; background: #f8fafc; transition: 0.2s; }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); outline: none; background: white; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }

        .grid-2 { display: grid; grid-template-columns: 1fr; gap: 20px; } /* Mobile 1 col */

        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: 600; color: white; cursor: pointer; margin-top: 20px; font-size: 1rem; }
        .btn-primary { background: var(--primary); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }

        .canvas-box { border: 2px dashed #cbd5e1; border-radius: 10px; background: #fff; padding: 4px; }
        canvas { width: 100%; height: 150px; display: block; background: #fff; cursor: crosshair; touch-action: none; }

        /* =========================================
           LAPTOP / PC VIEW (YANG PENTING NI!)
           ========================================= */
        @media (min-width: 1024px) {
            /* Landing Page: Split Screen */
            #landing-page { flex-direction: row; gap: 60px; }
            .landing-box { text-align: left; }
            .menu-grid { grid-template-columns: repeat(3, 1fr); max-width: 900px; }
            .menu-card { flex-direction: column; text-align: center; padding: 30px; }

            /* Dashboard: Fixed Sidebar Layout */
            .mobile-header { display: none; } /* Sorok header mobile */
            
            .sidebar { 
                transform: translateX(0); /* Sentiasa nampak */
                box-shadow: 5px 0 20px rgba(0,0,0,0.05); /* Bayang cantik */
            }

            .main-content {
                margin-left: var(--sidebar-width); /* Tolak content ke kanan */
                height: 100vh; /* Full height */
                padding: 40px; /* Ruang luas */
            }

            .grid-2 { grid-template-columns: 1fr 1fr; } /* Form jadi 2 column */
        }
    </style>
</head>
<body>

    <div id="landing-page">
        <div class="landing-box">
            <h1 style="font-size:3rem; margin:0; line-height:1.1;">Portal Aset ICT</h1>
            <p style="color:#94a3b8; font-size:1.1rem; margin-top:15px">Sistem Pengurusan & Laporan Kerosakan</p>
            
            <div class="footer-credit">
                Dibangunkan oleh: <br><strong style="color:white; font-size:1rem">Nurul Syuhaida (Student Intern)</strong>
            </div>
        </div>

        <div class="menu-grid">
            <div class="menu-card" onclick="enterSystem('page-cikgu')">
                <div style="font-size:2rem">üìù</div>
                <div><div style="font-weight:700; color:white">Borang Aset</div><small style="color:#94a3b8">Isi Maklumat</small></div>
            </div>
            <div class="menu-card" onclick="enterSystem('page-admin-check')">
                <div style="font-size:2rem">üîê</div>
                <div><div style="font-weight:700; color:white">Admin IT</div><small style="color:#94a3b8">Login Pegawai</small></div>
            </div>
            <div class="menu-card" onclick="enterSystem('page-notepad')">
                <div style="font-size:2rem">üìå</div>
                <div><div style="font-weight:700; color:white">Nota</div><small style="color:#94a3b8">Catatan Peribadi</small></div>
            </div>
        </div>
    </div>

    <div id="app-container">
        
        <div class="mobile-header">
            <button class="hamburger" onclick="toggleSidebar()">‚ò∞</button>
            <b id="header-title">Menu Utama</b>
            <div style="width:20px"></div>
        </div>

        <div class="overlay" onclick="toggleSidebar()"></div>

        <div class="sidebar" id="sidebar">
            <div class="brand-logo">
                <span style="background:var(--primary); width:35px; height:35px; display:flex; align-items:center; justify-content:center; border-radius:8px">üöÄ</span>
                E-Aset Pro
            </div>
            
            <div class="nav-link" id="nav-cikgu" onclick="switchTab('page-cikgu')"><span>üìù</span> Borang Serahan</div>
            <div class="nav-link" id="nav-admin" onclick="checkAdmin()"><span>üõ†Ô∏è</span> Dashboard IT</div>
            <div class="nav-link" id="nav-note" onclick="switchTab('page-notepad')"><span>üìå</span> Notepad</div>
            
            <div style="flex:1"></div> <div class="nav-link" onclick="exitSystem()" style="background:rgba(255,255,255,0.05); color:#f87171"><span>üö™</span> Keluar Sistem</div>

            <div class="creator-badge">
                <small>Created by</small>
                <b>Nurul Syuhaida</b>
            </div>
        </div>

        <div class="main-content">
            
            <div id="page-cikgu" class="page-section active">
                <div class="card">
                    <h2>üìù Borang Serahan Aset</h2>
                    
                    <div class="grid-2">
                        <div class="input-group">
                            <label>Nama Penghantar</label>
                            <input type="text" id="c_name" placeholder="Nama Penuh">
                        </div>
                        <div class="input-group">
                            <label>Jenis Peralatan</label>
                            <select id="c_asset"><option>Printer</option><option>Laptop</option><option>PC</option><option>Projektor</option><option>Lain-lain</option></select>
                        </div>
                    </div>
                    
                    <div class="grid-2">
                        <div class="input-group">
                            <label>No. Siri Aset (Wajib)</label>
                            <input type="text" id="c_serial" style="text-transform:uppercase" placeholder="Contoh: KPM-1234">
                        </div>
                        <div class="input-group">
                            <label>Tarikh Serahan</label>
                            <input type="date" id="c_date">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Keterangan Masalah</label>
                        <textarea id="c_note" rows="3" placeholder="Sila nyatakan kerosakan..."></textarea>
                    </div>

                    <label>Tandatangan Penghantar</label>
                    <div class="canvas-box">
                        <canvas id="cvs-cikgu"></canvas>
                    </div>
                    <div onclick="clearCvs('cvs-cikgu')" style="color:red; font-size:0.8rem; text-align:right; margin-top:5px; cursor:pointer; font-weight:600">Padam Sign ‚ùå</div>

                    <button class="btn btn-primary" onclick="submitForm()">HANTAR BORANG</button>
                </div>
            </div>

            <div id="page-admin" class="page-section">
                <div class="card">
                    <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding-bottom:15px; margin-bottom:20px">
                        <h2 style="margin:0; border:none">Dashboard IT</h2>
                        <button onclick="downloadExcel()" style="background:#10b981; color:white; border:none; padding:8px 15px; border-radius:6px; font-weight:600; cursor:pointer">üì• Download Excel</button>
                    </div>

                    <div id="pending-list"></div>

                    <div style="margin-top:30px">
                        <h4 style="color:#64748b; margin-bottom:10px">Sejarah Rekod</h4>
                        <div style="overflow-x:auto; border:1px solid #e2e8f0; border-radius:10px">
                            <table id="db-table" style="width:100%; border-collapse:collapse; font-size:0.9rem; background:white;">
                                <thead style="background:#f8fafc; color:#475569">
                                    <tr><th style="padding:12px; text-align:left">Tarikh</th><th style="padding:12px; text-align:left">Perkara</th><th style="padding:12px; text-align:left">Status</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-process" class="page-section">
                <button onclick="switchTab('page-admin')" style="background:white; border:1px solid #ccc; padding:8px 15px; border-radius:6px; margin-bottom:15px; cursor:pointer">‚¨Ö Kembali</button>
                
                <div class="card" style="border-top:4px solid #f59e0b">
                    <h2>üõ†Ô∏è Proses Tindakan</h2>
                    
                    <div id="process-info" style="background:#eff6ff; padding:20px; border-radius:10px; border:1px solid #bfdbfe; color:#1e3a8a; margin-bottom:20px"></div>

                    <div class="grid-2">
                        <div class="input-group">
                            <label>Pegawai IT Bertugas</label>
                            <input type="text" id="it_name">
                        </div>
                        <div class="input-group">
                            <label>Keputusan / Status</label>
                            <select id="it_status">
                                <option>Dalam Tindakan</option>
                                <option>Selesai - Dibaiki</option>
                                <option>Dipulangkan</option>
                                <option>Lupus (BER)</option>
                            </select>
                        </div>
                    </div>

                    <label>Tandatangan Pegawai IT</label>
                    <div class="canvas-box">
                        <canvas id="cvs-it"></canvas>
                    </div>
                    <div onclick="clearCvs('cvs-it')" style="color:red; font-size:0.8rem; text-align:right; margin-top:5px; cursor:pointer; font-weight:600">Padam Sign IT ‚ùå</div>

                    <button class="btn btn-primary" onclick="saveIT()">SIMPAN STATUS</button>
                </div>
            </div>

            <div id="page-notepad" class="page-section">
                <div class="card">
                    <h2>üìå Nota Peribadi</h2>
                    <div style="display:flex; gap:10px">
                        <input type="text" id="note-text" placeholder="Tulis nota ringkas...">
                        <button onclick="addNote()" style="width:auto; padding:0 20px; background:var(--primary); color:white; border:none; border-radius:8px; cursor:pointer">Tambah</button>
                    </div>
                    <div id="note-grid" style="margin-top:20px; display:grid; gap:10px"></div>
                </div>
            </div>

        </div>
    </div>

<script>
    // --- UI CONTROL ---
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
        document.querySelector('.overlay').classList.toggle('show');
    }

    function enterSystem(page) {
        if(page === 'page-admin-check') { checkAdmin(); return; }
        document.getElementById('landing-page').style.transform = 'translateY(-100%)';
        setTimeout(() => {
            document.getElementById('app-container').classList.add('active');
            switchTab(page);
        }, 300);
    }

    function exitSystem() {
        if(confirm("Kembali ke menu utama?")) {
            document.getElementById('app-container').classList.remove('active');
            document.getElementById('landing-page').style.transform = 'translateY(0)';
            if(window.innerWidth < 1024) toggleSidebar();
        }
    }

    function switchTab(id) {
        // Hide all pages
        document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        
        // Active Sidebar Link
        document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
        if(id.includes('cikgu')) document.getElementById('nav-cikgu').classList.add('active');
        if(id.includes('admin') || id.includes('process')) document.getElementById('nav-admin').classList.add('active');
        if(id.includes('note')) document.getElementById('nav-note').classList.add('active');

        // Header Title (Mobile)
        const t = {'page-cikgu':'Borang Aset','page-admin':'Admin Dashboard','page-process':'Proses','page-notepad':'Nota'};
        document.getElementById('header-title').innerText = t[id] || 'Menu';

        if(window.innerWidth < 1024) { // Auto close mobile sidebar
            document.getElementById('sidebar').classList.remove('open');
            document.querySelector('.overlay').classList.remove('show');
        }

        setTimeout(() => { resizeCvs('cvs-cikgu'); resizeCvs('cvs-it'); }, 200);
    }

    // --- CANVAS (SIGNATURE) ---
    function resizeCvs(id) {
        const c = document.getElementById(id);
        c.width = c.parentElement.offsetWidth;
        c.height = 150;
    }
    function setupCvs(id) {
        const c = document.getElementById(id);
        const ctx = c.getContext('2d');
        let draw = false;
        
        const pos = (e) => {
            const r = c.getBoundingClientRect();
            return { x: (e.touches?e.touches[0].clientX:e.clientX)-r.left, y: (e.touches?e.touches[0].clientY:e.clientY)-r.top };
        }
        
        ['mousedown','touchstart'].forEach(ev=>c.addEventListener(ev,(e)=>{ if(ev=='touchstart')e.preventDefault(); draw=true; ctx.beginPath(); ctx.moveTo(pos(e).x, pos(e).y); }));
        ['mousemove','touchmove'].forEach(ev=>c.addEventListener(ev,(e)=>{ if(ev=='touchmove')e.preventDefault(); if(draw){ ctx.lineTo(pos(e).x, pos(e).y); ctx.stroke(); } }));
        ['mouseup','touchend'].forEach(ev=>c.addEventListener(ev,()=>draw=false));
        window.addEventListener('resize', ()=>resizeCvs(id));
    }
    setupCvs('cvs-cikgu'); setupCvs('cvs-it');
    function clearCvs(id) { const c=document.getElementById(id); c.getContext('2d').clearRect(0,0,c.width,c.height); }

    // --- DATA LOGIC ---
    let db = JSON.parse(localStorage.getItem('asetDB_final')) || []; // Maintain same DB
    let notes = JSON.parse(localStorage.getItem('notesDB_final')) || [];
    let curId = null;
    document.getElementById('c_date').valueAsDate = new Date();

    function submitForm() {
        const n = document.getElementById('c_name').value;
        const s = document.getElementById('c_serial').value;
        if(!n || !s) return alert("Sila isi Nama & No Siri!");
        
        db.push({ id:Date.now(), date:document.getElementById('c_date').value, name:n, serial:s.toUpperCase(), asset:document.getElementById('c_asset').value, note:document.getElementById('c_note').value, status:'PENDING', itName:'-' });
        localStorage.setItem('asetDB_final', JSON.stringify(db));
        alert("‚úÖ Berjaya hantar!");
        document.getElementById('c_name').value=""; document.getElementById('c_serial').value=""; document.getElementById('c_note').value="";
        clearCvs('cvs-cikgu');
    }

    function checkAdmin() {
        if(prompt("Password IT:")==="admin123") {
            document.getElementById('landing-page').style.transform='translateY(-100%)';
            document.getElementById('app-container').classList.add('active');
            switchTab('page-admin'); renderAdmin();
        } else alert("Salah!");
    }

    function renderAdmin() {
        const list = document.getElementById('pending-list');
        const tb = document.querySelector('#db-table tbody');
        list.innerHTML = ""; tb.innerHTML = "";
        
        db.slice().reverse().forEach(x => {
            const badge = x.status==='PENDING' ? '<span style="color:#d97706; background:#fef3c7; padding:3px 8px; border-radius:10px; font-size:0.75rem; font-weight:700">Menunggu</span>' : '<span style="color:#166534; background:#dcfce7; padding:3px 8px; border-radius:10px; font-size:0.75rem; font-weight:700">Selesai</span>';
            tb.innerHTML += `<tr style="border-bottom:1px solid #f1f5f9"><td style="padding:12px">${x.date}</td><td style="padding:12px"><b>${x.name}</b><br><small style="color:#64748b">${x.asset} (${x.serial})</small></td><td style="padding:12px">${badge}</td></tr>`;
            
            if(x.status==='PENDING') {
                list.innerHTML += `<div style="background:#fffbeb; border:1px solid #fcd34d; padding:15px; border-radius:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center"><div><b>${x.asset}</b> (${x.serial})<br><small>Oleh: ${x.name}</small></div><button onclick="proc(${x.id})" style="background:#f59e0b; color:white; border:none; padding:8px 15px; border-radius:6px; cursor:pointer">Proses</button></div>`;
            }
        });
        if(!list.innerHTML) list.innerHTML = "<div style='text-align:center; padding:20px; color:#ccc; border:2px dashed #eee; border-radius:10px'>Tiada tugasan baru.</div>";
    }

    function proc(id) {
        curId = id; const item = db.find(x=>x.id===id);
        document.getElementById('process-info').innerHTML = `<b>Aset:</b> ${item.asset} <br><b>Masalah:</b> ${item.note}`;
        clearCvs('cvs-it'); switchTab('page-process');
    }

    function saveIT() {
        const idx = db.findIndex(x=>x.id===curId);
        if(idx!==-1) {
            db[idx].itName = document.getElementById('it_name').value;
            db[idx].status = document.getElementById('it_status').value;
            localStorage.setItem('asetDB_final', JSON.stringify(db));
            alert("Disimpan!"); switchTab('page-admin'); renderAdmin();
        }
    }

    function addNote() {
        const t = document.getElementById('note-text').value;
        if(t) { notes.push({id:Date.now(), text:t}); localStorage.setItem('notesDB_final', JSON.stringify(notes)); document.getElementById('note-text').value=""; renNote(); }
    }
    function renNote() {
        document.getElementById('note-grid').innerHTML = notes.slice().reverse().map(n=>`<div style="background:white; padding:15px; border-radius:8px; border:1px solid #eee; display:flex; justify-content:space-between"><span>${n.text}</span><span onclick="delNote(${n.id})" style="color:red; cursor:pointer">‚úï</span></div>`).join('');
    }
    function delNote(id) { notes=notes.filter(n=>n.id!==id); localStorage.setItem('notesDB_final', JSON.stringify(notes)); renNote(); }

    function downloadExcel() {
        let csv = "ID,Tarikh,Nama,Aset,Serial,Masalah,Status,IT Name\n" + db.map(r => `${r.id},"${r.date}","${r.name}","${r.asset}","${r.serial}","${r.note}","${r.status}","${r.itName}"`).join("\n");
        const a = document.createElement('a'); a.href='data:text/csv;charset=utf-8,'+encodeURI(csv); a.download='Laporan_Aset.csv'; a.click();
    }
    
    // Init Canvas Size
    setTimeout(() => { resizeCvs('cvs-cikgu'); resizeCvs('cvs-it'); }, 500);
</script>

</body>
</html>
